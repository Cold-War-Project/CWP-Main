namespace = united_kingdom_post_war_events

# Events beginning with .1 --> Rationing/Consumer Demand Control
# Events beginning with .9 --> Behind the scenes setup & clean up 

###############################
########## Rationing ##########
###############################
united_kingdom_post_war_events.100 = { # Start the Rationing
	type = country_event
	title = united_kingdom_post_war_events.100.title
	desc = united_kingdom_post_war_events.100.desc
	flavor = united_kingdom_post_war_events.100.flavor
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = { video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2" }
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		game_date >= 1946.1.1 # Game Start
		this = c:GBR # United Kingdom only
		NOT = { has_variable = gbr_rationing_over }
	}		
	
	immediate = { }
	
	option = {
		name = united_kingdom_post_war_events.100.a
		default_option = yes
		
		ai_chance = {
			base = 100
		}
	}
}

united_kingdom_post_war_events.101 = {
	# Pound Sterling Devaluation
	# Determine what the new value of the pound sterling will be when devaluing it
	type = country_event
	title = united_kingdom_post_war_events.101.title
	desc = united_kingdom_post_war_events.101.desc
	flavor = united_kingdom_post_war_events.101.flavor
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = { video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2" }
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1
	
	immediate = {
		remove_modifier = gbr_goods_demand_pressure
		remove_modifier = gbr_forced_currency_devaluation
		add_modifier = {
			name = gbr_forced_currency_devaluation
			multiplier = var:gbr_rationing_demand_pressure_rate
			is_decaying = yes
			months = 18
		}
		if = { limit = { var:gbr_rationing_demand_pressure_rate < 20 }
			change_global_variable = { name = currency_gbp_v multiply = 0.95 } # 5% Devaluation
		}
		else_if = {
			limit = {
				var:gbr_rationing_demand_pressure_rate >= 20
				var:gbr_rationing_demand_pressure_rate < 30
			}
			change_global_variable = { name = currency_gbp_v multiply = 0.90 } # 10% Devaluation
		}
		else_if = {
			limit = {
				var:gbr_rationing_demand_pressure_rate >= 30
				var:gbr_rationing_demand_pressure_rate < 40
			}
			change_global_variable = { name = currency_gbp_v multiply = 0.85 } # 15% Devaluation
		}
		else_if = { limit = { var:gbr_rationing_demand_pressure_rate >= 40 }
			change_global_variable = { name = currency_gbp_v multiply = 0.80 } # 20% Devaluation
		}
		set_variable = { name = gbr_rationing_demand_pressure_rate value = 0 }
	}
	
	option = {
		name = united_kingdom_post_war_events.101.a
		default_option = yes
				
		remove_variable = gbr_devalue_button_pressed
		
		ai_chance = {
			base = 100
		}
	}
}

united_kingdom_post_war_events.102 = { # End the Rationing
	type = country_event
	title = united_kingdom_post_war_events.102.title
	desc = united_kingdom_post_war_events.102.desc
	flavor = united_kingdom_post_war_events.102.flavor
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = { video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2" }
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3		
	
	immediate = {
		add_modifier = {
			name = gbr_rationing_successful
			multiplier = 25
			is_decaying = yes
			months = var:gbr_months_of_rationing
		}
	}
	
	option = {
		name = united_kingdom_post_war_events.102.a
		default_option = yes
		
		ai_chance = {
			base = 100
		}
	}
}

united_kingdom_post_war_events.103 = { # 10 Years of Rationg = Failure (End the Rationing)
	type = country_event
	title = united_kingdom_post_war_events.103.title
	desc = united_kingdom_post_war_events.103.desc
	flavor = united_kingdom_post_war_events.103.flavor
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = { video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2" }
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1		
	
	immediate = {
		remove_modifier = gbr_goods_demand_pressure
		add_modifier = {
			name = gbr_goods_demand_pressure
			multiplier = var:gbr_rationing_number_of_goods
			is_decaying = yes
			months = 120
		}
	}
	
	option = {
		name = united_kingdom_post_war_events.103.a
		default_option = yes
		
		ai_chance = {
			base = 100
		}
	}
}

united_kingdom_post_war_events.104 = { # Government ending rationing early
	type = country_event
	title = united_kingdom_post_war_events.104.title
	desc = united_kingdom_post_war_events.104.desc
	flavor = united_kingdom_post_war_events.104.flavor
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = { video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2" }
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1		
	
	immediate = {
		remove_modifier = gbr_goods_demand_pressure
		if = { limit = { var:gbr_months_of_rationing < 24 }
			add_modifier = {
				name = gbr_goods_demand_pressure
				multiplier = var:gbr_rationing_number_of_goods
				is_decaying = yes
				months = 120
			}
		}
		else_if = {
			limit = {
				var:gbr_months_of_rationing < 48
				var:gbr_months_of_rationing >= 24
			}
			add_modifier = {
				name = gbr_goods_demand_pressure
				multiplier = var:gbr_rationing_number_of_goods
				is_decaying = yes
				months = 96
			}
		}
		else_if = {
			limit = {
				var:gbr_months_of_rationing < 72
				var:gbr_months_of_rationing >= 48
			}
			add_modifier = {
				name = gbr_goods_demand_pressure
				multiplier = var:gbr_rationing_number_of_goods
				is_decaying = yes
				months = 72
			}
		}
		else_if = {
			limit = {
				var:gbr_months_of_rationing < 96
				var:gbr_months_of_rationing >= 72
			}
			add_modifier = {
				name = gbr_goods_demand_pressure
				multiplier = var:gbr_rationing_number_of_goods
				is_decaying = yes
				months = 48
			}
		}
		else = {
			limit = { var:gbr_months_of_rationing >= 96 }
			add_modifier = {
				name = gbr_goods_demand_pressure
				multiplier = var:gbr_rationing_number_of_goods
				is_decaying = yes
				months = 48
			}
		}
	}
	
	option = {
		name = united_kingdom_post_war_events.104.a
		default_option = yes
		
		ai_chance = {
			base = 100
		}
	}
}

######################################
########## Setup & Clean Up ##########
######################################

united_kingdom_post_war_events.901 {
	# Determine goods to be rationed at game start
	type = country_event
	hidden = yes
	
	immediate = {
		gbr_start_rationing_aluminum = yes
		gbr_start_rationing_bauxite = yes
		gbr_start_rationing_fertilizer = yes
		gbr_start_rationing_clothes = yes
		gbr_start_rationing_coal = yes
		gbr_start_rationing_coffee = yes
		gbr_start_rationing_copper = yes
		gbr_start_rationing_engines = yes
		gbr_start_rationing_explosives = yes
		gbr_start_rationing_fabric = yes
		gbr_start_rationing_fish = yes
		gbr_start_rationing_fruit = yes
		gbr_start_rationing_glass = yes
		gbr_start_rationing_grain = yes
		gbr_start_rationing_groceries = yes
		gbr_start_rationing_high_quality_fabric = yes
		gbr_start_rationing_iron = yes
		gbr_start_rationing_lead = yes
		gbr_start_rationing_liquor = yes
		gbr_start_rationing_meat = yes
		gbr_start_rationing_oil = yes
		gbr_start_rationing_opium = yes
		gbr_start_rationing_paper = yes
		gbr_start_rationing_pharmaceuticals = yes
		gbr_start_rationing_phosphorus = yes
		gbr_start_rationing_plastics = yes
		gbr_start_rationing_refined_fuel = yes
		gbr_start_rationing_rubber = yes
		gbr_start_rationing_steel = yes
		gbr_start_rationing_sugar = yes
		gbr_start_rationing_tea = yes
		gbr_start_rationing_tobacco = yes
		gbr_start_rationing_tools = yes
		gbr_start_rationing_wine = yes
		gbr_start_rationing_wood = yes
	}
}

united_kingdom_post_war_events.902 {
	# Variables & Modifiers clean up
	type = country_event
	hidden = yes
	
	immediate = {
		gbr_remove_core_variables = yes
		gbr_remove_aluminum_variables = yes
		gbr_remove_bauxite_variables = yes
		gbr_remove_fertilizer_variables = yes
		gbr_remove_clothes_variables = yes
		gbr_remove_coal_variables = yes
		gbr_remove_coffee_variables = yes
		gbr_remove_copper_variables = yes
		gbr_remove_engines_variables = yes
		gbr_remove_explosives_variables = yes
		gbr_remove_fabric_variables = yes
		gbr_remove_fish_variables = yes
		gbr_remove_fruit_variables = yes
		gbr_remove_glass_variables = yes
		gbr_remove_grain_variables = yes
		gbr_remove_groceries_variables = yes
		gbr_remove_high_quality_fabric_variables = yes
		gbr_remove_iron_variables = yes
		gbr_remove_lead_variables = yes
		gbr_remove_liquor_variables = yes
		gbr_remove_meat_variables = yes
		gbr_remove_oil_variables = yes
		gbr_remove_opium_variables = yes
		gbr_remove_paper_variables = yes
		gbr_remove_pharmaceuticals_variables = yes
		gbr_remove_phosphorus_variables = yes
		gbr_remove_plastics_variables = yes
		gbr_remove_refined_fuel_variables = yes
		gbr_remove_rubber_variables = yes
		gbr_remove_steel_variables = yes
		gbr_remove_sugar_variables = yes
		gbr_remove_tea_variables = yes
		gbr_remove_tobacco_variables = yes
		gbr_remove_tools_variables = yes
		gbr_remove_wine_variables = yes
		gbr_remove_wood_variables = yes
	}
}