setup_parties = {
	if = {
		limit = {
			not = {
				has_variable = agrarian_party_morale
			}
		}
		set_variable = {
			name = agrarian_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = agrarian_party_cohesion
			}
		}
		set_variable = {
			name = agrarian_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = anarchist_party_morale
			}
		}
		set_variable = {
			name = anarchist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = anarchist_party_cohesion
			}
		}
		set_variable = {
			name = anarchist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = centrist_party_morale
			}
		}
		set_variable = {
			name = centrist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = centrist_party_cohesion
			}
		}
		set_variable = {
			name = centrist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = christian_democrat_party_morale
			}
		}
		set_variable = {
			name = christian_democrat_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = christian_democrat_party_cohesion
			}
		}
		set_variable = {
			name = christian_democrat_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = communist_party_morale
			}
		}
		set_variable = {
			name = communist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = communist_party_cohesion
			}
		}
		set_variable = {
			name = communist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = conservative_party_morale
			}
		}
		set_variable = {
			name = conservative_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = conservative_party_cohesion
			}
		}
		set_variable = {
			name = conservative_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = democratic_socialist_party_morale
			}
		}
		set_variable = {
			name = democratic_socialist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = democratic_socialist_party_cohesion
			}
		}
		set_variable = {
			name = democratic_socialist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = fascist_party_morale
			}
		}
		set_variable = {
			name = fascist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = fascist_party_cohesion
			}
		}
		set_variable = {
			name = fascist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = feminist_party_morale
			}
		}
		set_variable = {
			name = feminist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = feminist_party_cohesion
			}
		}
		set_variable = {
			name = feminist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = green_party_morale
			}
		}
		set_variable = {
			name = green_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = green_party_cohesion
			}
		}
		set_variable = {
			name = green_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = islamist_party_morale
			}
		}
		set_variable = {
			name = islamist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = islamist_party_cohesion
			}
		}
		set_variable = {
			name = islamist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = liberal_party_morale
			}
		}
		set_variable = {
			name = liberal_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = liberal_party_cohesion
			}
		}
		set_variable = {
			name = liberal_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = libertarian_party_morale
			}
		}
		set_variable = {
			name = libertarian_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = libertarian_party_cohesion
			}
		}
		set_variable = {
			name = libertarian_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = monarchist_party_morale
			}
		}
		set_variable = {
			name = monarchist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = monarchist_party_cohesion
			}
		}
		set_variable = {
			name = monarchist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = pacifist_party_morale
			}
		}
		set_variable = {
			name = pacifist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = pacifist_party_cohesion
			}
		}
		set_variable = {
			name = pacifist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = social_democrat_party_morale
			}
		}
		set_variable = {
			name = social_democrat_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = social_democrat_party_cohesion
			}
		}
		set_variable = {
			name = social_democrat_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = socialist_party_morale
			}
		}
		set_variable = {
			name = socialist_party_morale
			value = 0
		}
	}
	if = {
		limit = {
			not = {
				has_variable = socialist_party_cohesion
			}
		}
		set_variable = {
			name = socialist_party_cohesion
			value = 0
		}
	}
	if = {
		limit = {
			country_has_voting_franchise = yes
		}
		calculate_party_cohesion = {
			PARTY = agrarian_party
		}
		calculate_party_cohesion = {
			PARTY = anarchist_party
		}
		calculate_party_cohesion = {
			PARTY = centrist_party
		}
		calculate_party_cohesion = {
			PARTY = christian_democrat_party
		}
		calculate_party_cohesion = {
			PARTY = communist_party
		}
		calculate_party_cohesion = {
			PARTY = conservative_party
		}
		calculate_party_cohesion = {
			PARTY = democratic_socialist_party
		}
		calculate_party_cohesion = {
			PARTY = fascist_party
		}
		calculate_party_cohesion = {
			PARTY = feminist_party
		}
		calculate_party_cohesion = {
			PARTY = green_party
		}
		calculate_party_cohesion = {
			PARTY = islamist_party
		}
		calculate_party_cohesion = {
			PARTY = liberal_party
		}
		calculate_party_cohesion = {
			PARTY = libertarian_party
		}
		calculate_party_cohesion = {
			PARTY = monarchist_party
		}
		calculate_party_cohesion = {
			PARTY = pacifist_party
		}
		calculate_party_cohesion = {
			PARTY = social_democrat_party
		}
		calculate_party_cohesion = {
			PARTY = socialist_party
		}
	}
}

calculate_party_cohesion = {
	every_potential_party = {
		limit = {
			is_party_type = $PARTY$
		}
		ROOT = {
			set_variable = {
				name = $PARTY$_cohesion
				value = 0
			}
		}
		every_member = {
			if = {
				limit = {
					and = {
						ig_approval < 0
						prev = {
							any_member = {
								and = {
									not = {
										is_same_interest_group_type = prev
									}
									ig_approval < 0
								}
							}
						}
					}
				}
				owner = {
					change_variable = {
						name = $PARTY$_cohesion
						add = 1
					}
				}
			}
			if = {
				limit = {
					and = {
						ig_approval < 5
						prev = {
							any_member = {
								and = {
									not = {
										is_same_interest_group_type = prev
									}
									ig_approval < 5
								}
							}
						}
					}
				}
				owner = {
					change_variable = {
						name = $PARTY$_cohesion
						add = 2
					}
				}
			}
			if = {
				limit = {
					and = {
						ig_approval < 10
						prev = {
							any_member = {
								and = {
									not = {
										is_same_interest_group_type = prev
									}
									ig_approval < 10
								}
							}
						}
					}
				}
				owner = {
					change_variable = {
						name = $PARTY$_cohesion
						add = 4
					}
				}
			}
			if = {
				limit = {
					and = {
						ig_approval > 0
						prev = {
							any_member = {
								and = {
									not = {
										is_same_interest_group_type = prev
									}
									ig_approval > 0
								}
							}
						}
					}
				}
				owner = {
					change_variable = {
						name = $PARTY$_cohesion
						add = 1
					}
				}
			}
			if = {
				limit = {
					and = {
						ig_approval > 5
						prev = {
							any_member = {
								and = {
									not = {
										is_same_interest_group_type = prev
									}
									ig_approval > 5
								}
							}
						}
					}
				}
				owner = {
					change_variable = {
						name = $PARTY$_cohesion
						add = 2
					}
				}
			}
			if = {
				limit = {
					and = {
						ig_approval > 10
						prev = {
							any_member = {
								and = {
									not = {
										is_same_interest_group_type = prev
									}
									ig_approval > 10
								}
							}
						}
					}
				}
				owner = {
					change_variable = {
						name = $PARTY$_cohesion
						add = 4
					}
				}
			}
		}
	}
}
